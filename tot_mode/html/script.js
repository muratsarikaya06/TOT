const backdrop=document.getElementById("backdrop"); const closeBtn=document.getElementById("closeBtn"); const modeButtons=document.querySelectorAll(".mode-btn"); let currentMode="none"; function openUi(data){currentMode=data.currentMode||"none";modeButtons.forEach(btn=>{btn.classList.toggle("active",btn.dataset.mode===currentMode);});backdrop.classList.remove("hidden");} function closeUi(){backdrop.classList.add("hidden");fetch(`https://tot_mode/close`,{method:"POST",body:JSON.stringify({})});} window.addEventListener("message",(e)=>{if(e.data.action==="open")openUi(e.data);if(e.data.action==="close")backdrop.classList.add("hidden");}); modeButtons.forEach(btn=>{btn.addEventListener("click",()=>{fetch(`https://tot_mode/selectMode`,{method:"POST",body:JSON.stringify({mode:btn.dataset.mode})});});}); closeBtn.onclick=()=>closeUi(); document.addEventListener("keydown",e=>{if(e.key==="Escape")closeUi();});